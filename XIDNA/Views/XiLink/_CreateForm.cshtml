@model XIDNA.Models.cBODisplay
@{
    //Layout = "~/Views/Shared/_XIDynawareLayout.cshtml";
    var oBOInstance = Model.BOInstance;

    var oVisualisations = Model.Visualisations;
    string ID = string.Empty;
    if (oBOInstance != null)
    {
        var IDPair = oBOInstance.NVPairs.Where(m => m.sName.ToLower() == "id").FirstOrDefault();
        if (IDPair != null)
        {
            ID = IDPair.sValue;
        }
    }
    int iInstanceID = 0;
    if (!string.IsNullOrEmpty(ID))
    {
        iInstanceID = Convert.ToInt32(ID);
    }
}
@if (Model.BOInstance != null)
{
    <div class="PopupTabContentArea">
        <div class="innerborder">
            <div class="alert alert-danger" id="BootstrpError" style="display:none;">
                <a href="#" class="close" data-dismiss="alert" aria-label="close">×</a>
            </div>
            <div class="alert alert-success" id="BootstrpAlertSuccess" style="display:none;">
                <a href="#" class="close" data-dismiss="alert" aria-label="close">×</a>
            </div>
            <div class="LeadContent">
                <div class="row">
                    <div class="col-xs-12 col-sm-8 col-md-8 col-lg-9 infobox-left">
                        <div class="LeadContent-table form-horizontal" style="margin-bottom:15px">
                            <div class="DetailsTable">
                                <div class="questionset-section">
                                    <form class="CreateForm">
                                        @foreach (var items in oBOInstance.NVPairs.Where(m => m.bDirty == true).ToList())
                                        {
                                            bool isLockField = items.bLock;
                                            if (items.sName.ToLower() != "id")
                                            {
                                                var FieldOrigin = oBOInstance.Definition.BOFields.Where(m => m.Name == items.sName).FirstOrDefault();
                                                if (FieldOrigin.IsOptionList)
                                                {
                                                    <div class="row form-group highlight--help">
                                                        <div class="col-md-6 col-lg-5 col-sm-12 col-xs-12">
                                                            <label class="control-label">@oBOInstance.Definition.BOFields.Where(m => m.Name.ToLower() == items.sName.ToLower()).Select(m => m.LabelName).FirstOrDefault()</label>
                                                        </div>
                                                        <div class="col-md-6 col-lg-7 col-sm-12 col-xs-12 pull-right col-content">
                                                            <select name="@items.sName" class="form-control" id="DDL-@items.sName" data-attrname="@items.sName">
                                                                @if (FieldOrigin.BOOptionLists != null)
                                                                {
                                                                    var OptValue = oBOInstance.NVPairs.Where(m => m.sName == items.sName).Select(s => s.sValue).FirstOrDefault();
                                                                    foreach (var opt in FieldOrigin.BOOptionLists)
                                                                    {
                                                                        if (OptValue == null)
                                                                        {
                                                                            if (!string.IsNullOrEmpty(FieldOrigin.DefaultValue))
                                                                            {
                                                                                if (opt.ID == Convert.ToInt32(FieldOrigin.DefaultValue))
                                                                                {
                                                                                    <option value="@opt.sValues" selected>@opt.sOptionName</option>
                                                                                }
                                                                                else
                                                                                {
                                                                                    <option value="@opt.sValues">@opt.sOptionName</option>
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                <option value="@opt.sValues">@opt.sOptionName</option>
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            if (opt.sValues == OptValue)
                                                                            {
                                                                                <option value="@opt.sValues" selected>@opt.sOptionName</option>
                                                                            }
                                                                            else
                                                                            {
                                                                                <option value="@opt.sValues">@opt.sOptionName</option>
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            </select>

                                                            @if (isLockField == true)
                                                            {

                                                            }
                                                        </div>
                                                        <button type="button" tabindex="-1" class="helptext-mobile-button btn btn-theme bc-theme fc-white btn-xs" data-toggle="tooltip" title="Info">
                                                            <i class="fa fa-info" tabindex="0" role="button"></i>
                                                        </button>
                                                        <div class="helptext">
                                                            <div class="helptext--desktop">
                                                                <div class="helptext__content">
                                                                    <a class="helptext-content-close"><i class="fa fa-close"></i></a>
                                                                    <p><strong>Lorem Ipsum</strong></p>
                                                                    <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                }
                                                else if (FieldOrigin.FKiType > 0)
                                                {
                                                    <div class="row form-group highlight--help">
                                                        <div class="col-md-6 col-lg-5 col-sm-12 col-xs-12">
                                                            <label class="control-label">@oBOInstance.Definition.BOFields.Where(m => m.Name.ToLower() == items.sName.ToLower()).Select(m => m.LabelName).FirstOrDefault()</label>
                                                        </div>
                                                        <div class="col-md-6 col-lg-7 col-sm-12 col-xs-12 pull-right col-content">
                                                            @if (Model.BOInstance.Definition.sSize == "10")
                                                            {
                                                                <select name="@items.sName" class="form-control" id="DDL-@items.sName" data-attrname="@items.sName">
                                                                    @{var OptValue = oBOInstance.NVPairs.Where(m => m.sName == items.sName).Select(s => s.sValue).FirstOrDefault();
                                                                        foreach (var opt in FieldOrigin.FieldDDL)
                                                                        {
                                                                            if (string.IsNullOrEmpty(OptValue))
                                                                            {
                                                                                if (!string.IsNullOrEmpty(FieldOrigin.DefaultValue))
                                                                                {
                                                                                    if (opt.ID == Convert.ToInt32(FieldOrigin.DefaultValue))
                                                                                    {
                                                                                        <option value="@opt.ID" selected>@opt.Expression</option>
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        <option value="@opt.ID">@opt.Expression</option>
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    <option value="@opt.ID">@opt.Expression</option>
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                if (opt.ID == Convert.ToInt32(OptValue))
                                                                                {
                                                                                    <option value="@opt.ID" selected>@opt.Expression</option>
                                                                                }
                                                                                else
                                                                                {
                                                                                    <option value="@opt.ID">@opt.Expression</option>
                                                                                }
                                                                            }
                                                                        }
                                                                    }
                                                                </select>
                                                                        }
                                                                        else if (Model.BOInstance.Definition.sSize == "20")
                                                                        {
                                                                            <input id="DDL-@items.sName" type="text" name="@items.sName" class="form-control XIField" />
                                                                        }
                                                                        else if (Model.BOInstance.Definition.sSize == "30")
                                                                        {
                                                                            <input type="text" class="form-control autocomplete" name="Orders" placeholder="Enter the name" id="DDL-@items.sName" data-value="0" onkeyup="fncgetautocomplete1('@FieldOrigin.iOneClickID', this, event)" />
                                                                        }
                                                            <div style="position:absolute;top:5px;right:-55px;">
                                                                <a href="#" class="btn btn-theme bc-theme btn-xs pull-left" style="margin-right:3px;" data-toggle="tooltip" title="Quick view">
                                                                    <i style="Color:#0094ff;" class="GetQuickView fa fa-eye fc-white" aria-hidden="true"></i>
                                                                </a>
                                                                <a href="#" class="btn btn-theme bc-theme btn-xs pull-left" style="margin-right:3px;" data-toggle="tooltip" title="Drill down">
                                                                    <i style="Color:#0094ff;" class="GetDrillDown fa fa-window-restore fc-white" aria-hidden="true"></i>
                                                                </a>
                                                            </div>
                                                        </div>

                                                        <button type="button" tabindex="-1" class="helptext-mobile-button btn btn-theme bc-theme fc-white btn-xs" data-toggle="tooltip" title="Info">
                                                            <i class="fa fa-info" tabindex="0" role="button"></i>
                                                        </button>
                                                        <div class="helptext">
                                                            <div class="helptext--desktop">
                                                                <div class="helptext__content">
                                                                    <a class="helptext-content-close"><i class="fa fa-close"></i></a>
                                                                    <p><strong>Lorem Ipsum</strong></p>
                                                                    <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                                        }
                                                                        else if (oBOInstance.Definition.BOFields.Where(m => m.Name == items.sName).Select(m => m.FKiFileTypeID).FirstOrDefault() > 0 && oBOInstance.Definition.BOFields.Where(m => m.Name == items.sName).Select(m => m.FKiType).FirstOrDefault() == 0)
                                                                        {
                                                                            <div class="row form-group highlight--help">
                                                                                <div class="col-md-6 col-lg-5 col-sm-12 col-xs-12">
                                                                                    <label class="control-label">@oBOInstance.Definition.BOFields.Where(m => m.Name.ToLower() == items.sName.ToLower()).Select(m => m.LabelName).FirstOrDefault()</label>
                                                                                </div>
                                                                                <div class="col-md-6 col-lg-7 col-sm-12 col-xs-12 pull-right col-content">
                                                                                    <input type="file" class="UploadImage" name="UploadImage" id="UploadImage-@items.sName" data-attrname="@items.sName" data-bofieldid="@oBOInstance.Definition.BOFields.Where(m => m.Name == items.sName).Select(m => m.ID).FirstOrDefault()" multiple />
                                                                                    @if (oBOInstance.Definition.BOFields.Where(m => m.Name == items.sName).Select(m => m.ImagePathDetails).Count() == 0)
                                                                                    {
                                                                                        <input class="IconDisplay" type="hidden" name="@items.sName" id="ImageID-@items.sName" value="0" />
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        <input type="hidden" name="@items.sName" id="ImageID-@items.sName" value="@items.sValue" />
                                                                                    }
                                                                                    <div class=form-group id="dvPreview-@items.sName">

                                                                                    </div>
                                                                                    @if (oBOInstance.Definition.BOFields.Where(m => m.Name == items.sName).Select(m => m.ImagePathDetails).Count() > 0)
                                                                                    {
                                                                                        var Images = oBOInstance.Definition.BOFields.Where(m => m.Name == items.sName).Select(m => m.ImagePathDetails);
                                                                                        foreach (var img in Images)
                                                                                        {
                                                                                            foreach (var item in img)
                                                                                            {
                                                                                                <img src="@item.Expression" width="50" height="50" />
                                                                                            }
                                                                                        }
                                                                                    }
                                                                                </div>
                                                                                <button type="button" tabindex="-1" class="helptext-mobile-button btn btn-theme bc-theme fc-white btn-xs" data-toggle="tooltip" title="Info">
                                                                                    <i class="fa fa-info" tabindex="0" role="button"></i>
                                                                                </button>
                                                                                <div class="helptext">
                                                                                    <div class="helptext--desktop">
                                                                                        <div class="helptext__content">
                                                                                            <a class="helptext-content-close"><i class="fa fa-close"></i></a>
                                                                                            <p><strong>Lorem Ipsum</strong></p>
                                                                                            <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</p>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="col-sm-4 taberrormsg">
                                                                                    <span class="@oBOInstance.Definition.Name-@items.sName"></span>
                                                                                </div>
                                                                            </div>
                                                                        }
                                                                        else if (oBOInstance.Definition.BOFields.Where(m => m.Name == items.sName).Select(m => m.TypeID == 150).FirstOrDefault())
                                                                        {
                                                                            <div class="row form-group highlight--help">
                                                                                <div class="col-md-6 col-lg-5 col-sm-12 col-xs-12">
                                                                                    <label class="control-label">@oBOInstance.Definition.BOFields.Where(m => m.Name.ToLower() == items.sName.ToLower()).Select(m => m.LabelName).FirstOrDefault()</label>
                                                                                </div>
                                                                                <div class="col-md-6 col-lg-7 col-sm-12 col-xs-12 pull-right col-content">
                                                                                    @Html.TextBoxFor(m => items.sValue, new { @Name = items.sName, @class = "form-control", @style = "padding:1px 5px;", @id = "Txtbx-DATETIME" })
                                                                                </div>
                                                                                <button type="button" tabindex="-1" class="helptext-mobile-button btn btn-theme bc-theme fc-white btn-xs" data-toggle="tooltip" title="Info">
                                                                                    <i class="fa fa-info" tabindex="0" role="button"></i>
                                                                                </button>
                                                                                <div class="helptext">
                                                                                    <div class="helptext--desktop">
                                                                                        <div class="helptext__content">
                                                                                            <a class="helptext-content-close"><i class="fa fa-close"></i></a>
                                                                                            <p><strong>Lorem Ipsum</strong></p>
                                                                                            <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</p>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="col-sm-4 taberrormsg">
                                                                                    <span class="@oBOInstance.Definition.Name-@items.sName"></span>
                                                                                </div>
                                                                            </div>
                                                                        }
                                                                        else
                                                                        {
                                                                            <div class="row form-group highlight--help">
                                                                                <div class="col-md-6 col-lg-5 col-sm-12 col-xs-12">
                                                                                    <label class="control-label">@oBOInstance.Definition.BOFields.Where(m => m.Name.ToLower() == items.sName.ToLower()).Select(m => m.LabelName).FirstOrDefault()</label>
                                                                                </div>
                                                                                <div class="col-md-6 col-lg-7 col-sm-12 col-xs-12 pull-right col-content">
                                                                                    @Html.TextBoxFor(m => items.sValue, new { @Name = items.sName, @class = "form-control", @style = "padding:1px 5px;" })
                                                                                </div>
                                                                                <button type="button" tabindex="-1" class="helptext-mobile-button btn btn-theme bc-theme fc-white btn-xs" data-toggle="tooltip" title="Info">
                                                                                    <i class="fa fa-info" tabindex="0" role="button"></i>
                                                                                </button>
                                                                                <div class="helptext">
                                                                                    <div class="helptext--desktop">
                                                                                        <div class="helptext__content">
                                                                                            <a class="helptext-content-close"><i class="fa fa-close"></i></a>
                                                                                            <p><strong>Lorem Ipsum</strong></p>
                                                                                            <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</p>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="col-sm-4 taberrormsg">
                                                                                    <span class="@oBOInstance.Definition.Name-@items.sName"></span>
                                                                                </div>
                                                                            </div>
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            <div class="row form-group highlight--help">
                                                                                <div class="col-md-6 col-lg-5 col-sm-12 col-xs-12">
                                                                                    <label class="control-label">@oBOInstance.Definition.BOFields.Where(m => m.Name.ToLower() == items.sName.ToLower()).Select(m => m.LabelName).FirstOrDefault()</label>
                                                                                </div>
                                                                                <div class="col-md-6 col-lg-7 col-sm-12 col-xs-12 pull-right col-content">
                                                                                    @Html.TextBoxFor(m => items.sValue, new { @Name = items.sName, @class = "form-control", @readonly = "readonly", @style = "padding:1px 5px;" })
                                                                                </div>
                                                                                <button type="button" tabindex="-1" class="helptext-mobile-button btn btn-theme bc-theme fc-white btn-xs" data-toggle="tooltip" title="Info">
                                                                                    <i class="fa fa-info" tabindex="0" role="button"></i>
                                                                                </button>
                                                                                <div class="helptext">
                                                                                    <div class="helptext--desktop">
                                                                                        <div class="helptext__content">
                                                                                            <a class="helptext-content-close"><i class="fa fa-close"></i></a>
                                                                                            <p><strong>Lorem Ipsum</strong></p>
                                                                                            <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</p>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="col-sm-4 taberrormsg">
                                                                                    <span class="@oBOInstance.Definition.Name-@items.sName"></span>
                                                                                </div>
                                                                            </div>
                                                                            }

                                                                        }
                                        @if (iInstanceID > 0)
                {
                                            @*<button type="button" class="SubmitBtn btn btn-theme">Update</button>*@
                                            <button type="button" class="btn btn-theme SubmitBtn"><i class="fa fa-edit"></i> Update</button>
                                            <button type="button" class="ApproveBtn btn btn-theme"><i class="fa fa-check"></i>Approve</button>

                                        }
                                        else
                                        {
                                            <button type="button" class="btn btn-theme SubmitBtn"><i class="fa fa-plus"></i> Create</button>
                                            @*<button type="button" class="SubmitBtn btn btn-theme">Create</button>*@
                                        }
                                        <button type="button" class="btn btn-theme decline  DlgClose"><i class="fa fa-close"></i> Cancel</button>
                                        @*<button type="button" class="btn btn-theme DlgClose">Cancel</button>*@
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
                                                                        }

<style>
    .thumbnail {
        float: left;
        margin-left: 10px;
    }

    .Logo {
        float: left;
        margin-right: 10px;
    }

    .Delete {
        margin-top: -95px;
    }

    .popover {
        background-color: #333740;
        border-radius: 2px;
        border: 1px solid #5e5e5e;
        font-size: 11px;
    }

    .popover-content {
        padding: 0px 2px;
    }

    .popover.top > .arrow:after {
        border-top-color: #333740;
        border-width: 8px;
        bottom: -6px;
    }

    .popover-content .table > tbody > tr > td, .popover-content .table > tbody > tr > th, .popover-content .table > tfoot > tr > td, .popover-content .table > tfoot > tr > th, .popover-content .table > thead > tr > td, .popover-content .table > thead > tr > th {
        padding: 3px;
    }
</style>
<script src="~/Scripts/ajaxfileupload.js"></script>
<script>

    $(document.body).on('change', "input.UploadImage", function () {
        var AttrName = $(this).attr('data-attrname');
        var ID = 0;
        var BOFieldID = $(this).attr('data-bofieldid');
        imagesPreview(this, AttrName);
        if ($("#UploadImage-" + AttrName).val() != "") {
            $.ajaxFileUpload({
                url: '@Url.Action("SaveFiles", "XiLink")',
                data: { ID: ID, BOFieldID: BOFieldID },
                secureuri: false,
                type: 'POST',
                fileElementId: "UploadImage-" + AttrName,
                dataType: 'json',
                success: function (response, ID) {
                    if (ID && ID.length > 0) {
                        $('#ImageID-' + AttrName).val(ID);
                    }
                },
                error: function (respose, ID) {
                }
            })
        }
    });

    var imagesPreview = function (input, AttrName) {
        if (input.files) {
            var filesAmount = input.files.length;
            $('div#dvPreview-' + AttrName).html('');
            for (i = 0; i < filesAmount; i++) {
                var reader = new FileReader();
                reader.onload = function (event) {
                    $($.parseHTML('<img>')).attr('src', event.target.result).attr('width', '50').attr('height', '50').appendTo("div#dvPreview-" + AttrName);
                }
                reader.readAsDataURL(input.files[i]);
            }
        }
    };

    $(document).ready(function () {
        //Dynamic autocomplete
        var oBOInstance = @Html.Raw(Json.Encode(Model));
        //if(oBOInstance.BOInstance){
        //    for(k =0;k<oBOInstance.BOInstance.Definition.BOFields.length;k++)
        //    {
        //        var AutoComNames = new Array();
        //        var sFKName = oBOInstance.BOInstance.Definition.BOFields[k].FKTableName;
        //        if(sFKName!=null)
        //        {
        //            var sName = oBOInstance.BOInstance.Definition.BOFields[k].Name;
        //            var DDLValues= oBOInstance.BOInstance.Definition.BOFields[k].FieldDDL;
        //            $(DDLValues != null)
        //            {
        //                for(e=0;e<DDLValues.length;e++)
        //                {
        //                    AutoComNames.push(DDLValues[e].Expression);
        //                }
        //                var jsonString = JSON.stringify(AutoComNames);
        //                var AllListNames =  JSON.parse(jsonString);
        //                var AvailableValues = AllListNames;
        //                $( '#DDL-' + sName ).autocomplete({
        //                    source: AvailableValues
        //                });
        //            }
        //        }
        //    }
        //}

        $('.DlgClose').click(function(){
            $('.ui-dialog-content').dialog('close');
        });

        $('.SubmitBtn').on('click', function () {
            var GUID = fncGetGUIDFromHTMLTree('LayoutGUID', this);
            var Context = fncGetContextFromHTMLTree('LayoutGUID', this);
            var oBOInstance = @Html.Raw(Json.Encode(Model.BOInstance));
            DataUpdate(this,oBOInstance,GUID, Context);
        });

        $(document.body).on('click', 'button.ApproveBtn', function () {
            var sGUID = fncGetGUIDFromHTMLTree('LayoutGUID', this);
            var Component = @Html.Raw(Json.Encode(Model.BOInstance));
            var iInstID=0;
            for(i=0;i<Component.NVPairs.length;i++){
                if(Component.NVPairs[i].sName == "ID"){
                    iInstID= Component.NVPairs[i].sValue;
                }
            }

            var BOID=Component.Definition.BOID;
            var pvalue = {XILinkID:49,
                sGUID:sGUID,
                iInstanceID: iInstID,
                iBOID:BOID}
            $.ajax({
                url: '@Url.Action("XIScripting", "XiLink")',
                type: 'POST',
                contentType: "application/json; charset=utf-8",
                datatype: "html",
                cache: false,
                data: JSON.stringify(pvalue),
                success: function (data) {
                    if(data!="")
                    {
                        var sSplitData=data.split("_");
                        var sStatusVal=sSplitData[0];
                        var sStatusMessage=sSplitData[1];
                        if(sStatusVal=="10")
                        {
                            $("#BootstrpAlertSuccess").show();
                            $("#BootstrpAlertSuccess").html(sStatusMessage);
                            $(function () {
                                setTimeout(function () {
                                    $("#BootstrpAlertSuccess").hide('blind', {}, 500)
                                }, 5000);
                            });
                        }
                        else if(sStatusVal=="20")
                        {
                            $("#BootstrpError").show();
                            $("#BootstrpError").html(sStatusMessage);
                            $(function () {
                                setTimeout(function () {
                                    $("#BootstrpError").hide('blind', {}, 500)
                                }, 5000);
                            });
                        }
                        else
                        {
                            $("#BootstrpError").show();
                            $("#BootstrpError").append(sStatusMessage);
                            $(function () {
                                setTimeout(function () {
                                    $("#BootstrpError").hide('blind', {}, 500)
                                }, 5000);
                            });
                        }
                    }
                }
            });
        });

        $('#ResetBtn').click(function () {
            $('.CreateFormDiv')[0].reset();
            $('.CreateFormDiv .taberrormsg').find('span').html('');
            $('.UploadImage')[0].reset();
            $('.IconDisplay')[0].reset();
            $('.thumbnail').attr('src', "");
            $('.thumbnail').empty();
            $('select option:selected').removeAttr('selected');
        });


        $('#Txtbx-DATETIME').datepicker({
            changeMonth: true,
            changeYear: true,
            inline: true,
            yearRange: '1990:2030'
        });

        $('.container').hide();
        $('.GetQuickView').popover({
            trigger: 'hover',
            //placement: 'right',
            html: true,
            //$(".GetQuickView").hover(function(){
            content: function () {
                var oBOInstance = @Html.Raw(Json.Encode(Model));
                var iBOIID=oBOInstance.BOInstance.Definition.BOID;
                var sTableName="";
                if(oBOInstance.BOInstance){
                    for(k =0;k<oBOInstance.BOInstance.Definition.BOFields.length;k++)
                    {
                        var sFKName = oBOInstance.BOInstance.Definition.BOFields[k].FKTableName;
                        if(sFKName!=null)
                        {
                            //sAttrName= oBOInstance.BOInstance.Definition.BOFields[k].Name;
                            sTableName=sFKName;
                        }
                    }
                    var cValue = {
                        BOIID:iBOIID,
                        //AttrName: sAttrName,
                        TableName:sTableName,
                        GroupName:"Summary Group"
                    }
                    $.ajax({
                        url: '@Url.Action("GetBOComponentQuickView", "XIComponents")',
                        type: 'POST',
                        contentType: "application/json; charset=utf-8",
                        datatype: "html",
                        cache: false,
                        data: JSON.stringify(cValue),
                        success: function (data) {
                            if(data!=null){
                                var rowvalues = "";
                                rowvalues = rowvalues + '<div class="popover-time">';
                                rowvalues = rowvalues + '<table class="table m-b-none">';
                                rowvalues = rowvalues + '<tbody>';
                                // rowvalues = rowvalues + '<thead>';
                                //added
                                rowvalues = rowvalues + '<tr>';
                                for (i = 0; i < data.NVPairs.length; i++) {

                                    rowvalues = rowvalues + '<thead>' + data.NVPairs[i].sName +'</thead>';
                                }
                                rowvalues = rowvalues + '</tr>';
                                rowvalues = rowvalues + '<tr>';
                                if (data!=null) {
                                    for (i = 0; i < data.NVPairs.length; i++) {
                                        //rowvalues = rowvalues + '<tr>';
                                        var IsImage = false;
                                        var BOFields = data.Definition.BOFields;
                                        for(j=0;j<BOFields.length;j++){
                                            if(data.NVPairs[i].sName == BOFields[j].Name){
                                                var FileType = BOFields[j].FKiFileTypeID;
                                                if(FileType>0){
                                                    IsImage = true;
                                                }
                                            }
                                        }
                                        if(IsImage){
                                            rowvalues = rowvalues + '<td><img src="' + data.NVPairs[i].sValue + '"></td>';
                                        }
                                        else{
                                            rowvalues = rowvalues + '<td>' + data.NVPairs[i].sValue + '</td>';
                                        }
                                        //rowvalues = rowvalues + '<td><img src="/Content/Files/png/2018/3/16/images_1_168_137.png"></td>';
                                        //rowvalues = rowvalues + '</tr>';
                                    }
                                }
                                rowvalues = rowvalues + '</tr>';
                                //rowvalues = rowvalues + '</thead>';
                                rowvalues = rowvalues + '</tbody>';
                                rowvalues = rowvalues + '</table>';
                                rowvalues = rowvalues + '</div>';
                                //$('.container').show();
                                $(".container").empty();
                                $(".container").append(rowvalues);
                            }
                            else{
                                $(".container").empty();
                            }
                        },
                        error: function (data) {
                            $(".container").empty();
                        }
                    });
                    var rowdata = $('.container').html();
                    return $(rowdata).html();
                }
            },
            container: 'body',
            placement: 'auto top'
        });

        var DrillDown = new Array();
        $(".GetDrillDown").click(function (ev) {
            //added BOID statically as autocomplete has issues
            var BOID=1;
            if (DrillDown.length > 0) {
                for (i = 0; i < DrillDown.length; i++) {
                    DrillDown[i].close();
                }
            }
            var editbo = window.open('', '_blank', "scrollbars=1,resizable=1,width=" + screen.width + ", height=" + screen.height);
            $.ajax({
                type: 'POST',
                url: '@Url.Action("GetDrillDown", "XIComponents")',
                data: { ID: BOID },
                cache: false,
                async: false,
                dataType: 'html',
                success: function (data) {
                    with (editbo.document) {
                        open();
                        write(data);
                        close();
                    }
                    DrillDown.push(editbo);
                    editbo.moveTo(0, 0);
                }
            });
        });

    });

    $(document).ready(function(){
        $(".highlight--help .helptext-mobile-button").on('click',function (e) {
            e.stopPropagation();
            $('.highlight--help').removeClass("helptext--visible");
            $(this).closest('.highlight--help').addClass('helptext--visible');
        });
        $(".helptext-content-close").on('click',function (e) {
            $(this).closest('.highlight--help').removeClass('helptext--visible');
        });

        $(".col-content input").focus(function () {
            $(this).closest('.highlight--help').addClass("helptext--visible");

        }).blur(function(){
            $(this).closest('.highlight--help').removeClass("helptext--visible");
        });
    });

    function fncgetautocomplete1(i1ClickID, $this, event) {
        var AutoCompleteLarge= '@Url.Action("GetAutoCompleteData", "XiLink")';
        var keyCode = event.keyCode || event.which;
        if (keyCode == 9) {
            return;
        }
        var offest = $($this).offset();
        var height = $($this).height();
        var SearchText = $($this).val();
        var FieldPlace = $($this).attr('id');
        if (SearchText.length > 0) {
            if (i1ClickID > 0) {
                if (bchangeTimer !== false) clearTimeout(bchangeTimer);
                bchangeTimer = setTimeout(function () {
                    $.ajax({
                        type: 'POST',
                        url: AutoCompleteLarge,
                        contentType: "application/json; charset=utf-8",
                        data: JSON.stringify({ i1ClickID: parseInt(i1ClickID), sAutoText: SearchText, sField: FieldPlace }),
                        cache: false,
                        async: false,
                        dataType: 'html',
                        success: function (data) {
                            $('#my_dialog').html(data);
                            if (acount == 0) {
                                $("#my_dialog").dialog({
                                    width: 550,
                                    dialogClass: "no-titlebar",
                                    open: function (event, ui) {
                                        $(event.target).parent().css('position', 'absolute');
                                        $(event.target).parent().css('top', offest.top + height + 15 + 'px');
                                        $(event.target).parent().css('left', offest.left + 'px');
                                    },
                                    close: function (event, ui) {
                                        acount = 0;
                                        $('#my_dialog').dialog('close');
                                        //$('#my_dialog').parent().hide();
                                        //$(this).dialog('destroy').remove();
                                    }
                                });
                                IsDialogOpen = true;
                            }
                            $('#' + FieldPlace).focus();
                            acount++;
                        }
                    });
                    bchangeTimer = false;
                }, 300);
            }
        }
        else {
            acount = 0;
            if (IsDialogOpen) {
                $('#my_dialog').dialog('close');
            }
        }
    }

</script>
<div id="my_dialog"></div>
<div class="container popover-time" style="display:none">


</div>